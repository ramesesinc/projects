<workunit extends="com/rameses/seti2/templates/WorkflowTaskList.xml" processName="business_application" 
          cols="app.appno,app.appyear,app.apptype,app.dtfiled,app.business.businessname,app.business.address.text,app.ownername,assignee.name,state"
          allowDelete="false" allowNotify="true">
    <invokers>
        <invoker folderid="/home/business/business_application" caption="Business Application List 2" 
                 action="init" index="100"/>
    </invokers>
    <code>
        import com.rameses.rcp.annotations.*;
            
        class ApplicationList extends com.rameses.seti2.models.WorkflowTaskListModel {
            def appyear;
            def years = [2011,2012,2013,2014,2015,2016,2017];
        
            @PropertyChangeListener
            def listener = [
                'appyear': { o->
                    reload();
                }
            ];    
        
            void initColumn(  def c ) {
                if(c.name=='app.appno') { c.caption = 'App No'; c.width = 120; }; 
                else if(c.name=='app.appyear') { c.caption = 'Year'; c.width = 80; }; 
                else if(c.name=='app.apptype') { c.caption = 'App Type'; c.width = 50; };
                else if(c.name=='app.businessname') { c.caption = 'Business Name'; c.width = 200; };        
                else if(c.name=='app.business.address.text') { c.caption = 'Business Address'; c.width = 200; };                
            }
        
            def getCustomFilter() {
                if( !appyear )  {
                    return null;
                }
                else {
                    return ["app.appyear=:appyear", [appyear: appyear] ];
                }
            }
        }
    </code>
    <pages>
        <page name="queryForm" template="com.rameses.gov.etracs.bpls.view.ApplicationListQuery"/>
    </pages>
</workunit>