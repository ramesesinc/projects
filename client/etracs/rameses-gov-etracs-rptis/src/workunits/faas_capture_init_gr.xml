<?xml version="1.0" encoding="UTF-8"?>
<workunit>
    <invokers>
        <invoker folderid="/explorer/txn/rpt/manual" action="init"  caption="General Revision" index="2" txntype="GR" role="ENCODER" generalRevision="11" permission="faas.createGeneralRevision"/>
         <invoker type="formActions" action="_close" caption="Close" mnemonic="c" icon="images/toolbars/cancel.png" immediate="true" />
         <invoker type="formActions" action="process" caption="Next" mnemonic="n" icon="images/toolbars/arrow_right.png" />
    </invokers>
    <code>
        
import com.rameses.rcp.annotations.* 
import com.rameses.rcp.common.* 
import com.rameses.osiris2.client.*
import com.rameses.osiris2.common.*

class GeneralRevisionInitController extends com.rameses.gov.etracs.rpt.faas.ui.FaasTxnInitController
{
        
    @Service('GeneralRevisionService')
    def grSvc;
    
    
    boolean generalRevision = true;
    
    
    void afterInit(){
        
    }
    
    def process(){
        entity.datacapture = true;
        entity = grSvc.createDataCaptureGeneralRevision( entity );
        return InvokerUtil.lookupOpener('faas:capture:create', [entity:entity]);
    }
    
    def getRevisionyears(){
        return grSvc.getRyList(entity.faas?.lguid, entity.faas?.ry, entity.faas?.rputype );
    }
    
    void afterLookupFaas(){
        binding.refresh('entity.newrysetting');
    }
    
    
}
        
    </code>
<pages>
    <page template="com.rameses.gov.etracs.rpt.faas.ui.FaasTxnInitPage"/>
</pages>    
</workunit>


