<workunit>
    <invokers>
        <invoker type="af_control:form:actions" caption="Change Mode"  target="popup"
                  xvisibleWhen="#{entity.state=='ISSUED'} "/>            
    </invokers>
   
    <code>
        import com.rameses.rcp.common.*;
        import com.rameses.rcp.annotations.*;
        import com.rameses.osiris2.client.*;
        import com.rameses.osiris2.common.*;
        import com.rameses.seti2.models.*;
        
        class AfControlChangeMode {
            
            @Service("AFControlService")
            def service;
        
            @Caller
            def caller;
        
            def entity;
        
            def doOk() {
                service.changeMode( [objid: entity.objid, txnmode: entity.txnmode ] );
                if(caller) caller.reloadEntity();
                return "_close";
            }

            def doCancel() {
                return "_close";
            }
        
        }
    </code>
   
    <pages>
        <page name="changemode" template="com.rameses.enterprise.treasury.views.AFChangeModePage" />
    </pages> 
       
</workunit>
