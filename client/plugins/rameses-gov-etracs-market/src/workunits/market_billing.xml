<workunit extends="com/rameses/seti2/templates/FormReport.xml">
    <invokers>
        <invoker type="market_account:form:formActions" 
            caption="View Billing" index="-10" 
            reportName="com/rameses/gov/etracs/market/reports/market_account_billing.jasper" 
            reportId="market_account_billing"
            target="popup"
            visibleWhen="#{mode=='read'}"
            action="preview"/>
    </invokers>
    <code>
        import com.rameses.rcp.common.*
        import com.rameses.osiris2.client.*
        import com.rameses.osiris2.common.*
        import com.rameses.seti2.models.*;
        import com.rameses.common.*;
        
        class MyReport extends FormReportModel {
            def preview() {
                def billdate = null;
                Modal.show("date:prompt", [handler: {o->billdate=o} ] );
                query.acctid = caller.entityContext?.objid;
                if(billdate) query.billdate = billdate;    
                return super.preview();
            };
        };
    </code>
    
</workunit>