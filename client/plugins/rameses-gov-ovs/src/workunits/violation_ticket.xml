<workunit schemaName="ovs_violation_ticket" allowEdit="false">
    <invokers>
        <invoker type="ovs_violation_ticket:create" caption="Violation Ticket" action="create" target="popup"/>
        <invoker type="ovs_violation_ticket:open" caption="Violation Ticket" action="open" target="popup"/>
    </invokers>
    <code>
        <![CDATA[
        import com.rameses.rcp.common.*;
        import com.rameses.rcp.annotations.*;
        import com.rameses.osiris2.client.*;
        import com.rameses.osiris2.common.*;
        import java.rmi.server.UID;
        import com.rameses.seti2.models.*;
        
        class ViolationTicketController extends CrudFormModel{
        
           @Service('ViolationTicketService')
           def violationSvc;
        
            public void afterColumnUpdate(String itemName, Object item, String colName){
                println 'Entity : ' + entity;
                def m = [violationid: item.violation.objid, violatorid: entity.violator.objid ];
                def z = violationSvc.getViolationInfo( m );
                item.putAll( z );
            }
            
            @PropertyChangeListener
            def listener = [
                "entity.apprehensionofficer" : {o ->
                    entity.apprehensionofficer.name = o.firstname + " " + o.lastname;
                }
            ];
            
        }
        ]]>
    </code>
    <pages>
        <page template="com.rameses.gov.etracs.ovs.views.ViolationTicketPage"/>        
    </pages>
</workunit>