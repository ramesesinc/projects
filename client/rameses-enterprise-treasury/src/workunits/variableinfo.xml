<workunit schemaName="variableinfo">
    <invokers>
        <invoker type="variableinfo:create" caption="Variable Info" action="create" target="popup" role="MASTER"/>
        <invoker type="variableinfo:open" caption="Variable Info" action="open" target="popup" role="MASTER"/>
    </invokers>
    <code>
        import com.rameses.rcp.common.*;
        import com.rameses.rcp.annotations.*;
        import com.rameses.osiris2.common.*;
        import com.rameses.seti2.models.*;
        
        class VariableInfoModel extends CrudFormModel {
        
            @PropertyChangeListener
            def listener = [
                "entity.datatype": {o->
                    entity.arrayvalues = []
                    binding.refresh('arrayvalue')
                }
            ]

            void afterCreate() {
                entity.system = 0;
                entity.arrayvalues = [];
            }
        
            void addArrayValue() {
                def value = MsgBox.prompt("Enter value: ")
                if( !value || value == 'null' ) return
                if( !entity.arrayvalues.find{ it == value } ) {
                    entity.arrayvalues.add(value.toUpperCase())
                    binding.refresh('arrayvalue')
                }
            }

            void removeArrayValue() {
                if( MsgBox.confirm("Remove selected array value?") ) {
                    entity.arrayvalues.remove(arrayvalue)
                    binding.refresh('arrayvalue')
                }
            }
                
        }
    
        </code>
    <pages>
        <page template="com.rameses.enterprise.treasury.views.VariableInfoPage"/>
    </pages>
</workunit>