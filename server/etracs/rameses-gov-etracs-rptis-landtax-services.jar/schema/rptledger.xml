<schema>
    <element tablename="rptledger">
        <field name="objid" primary="true" prefix="RL"/>
        <field name="state" required="true" caption="State" indexed="true" width="80"/>
        <field name="faasid" />
        <field name="nextbilldate" />
        <field name="lastyearpaid" required="true" type="integer" caption="Last Year Paid"  width="100"/>
        <field name="lastqtrpaid" required="true" type="integer" caption="Last Qtr Paid"  width="100"/>
        <field name="barangayid" required="true" />
        <field name="taxpayer_objid" required="true" />
        <field name="owner_name" required="true" caption="Owner" searchable="true"  width="200"/>
        <field name="administrator_name" caption="Administrator" searchable="true"  width="180"/>
        <field name="fullpin" required="true" caption="PIN" searchable="true"  width="160"/>
        <field name="tdno" required="true" caption="TD No." searchable="true"  width="130"/>
        <field name="cadastrallotno" caption="Lot No." searchable="true"  width="70"/>
        <field name="blockno" caption="Block No." searchable="true" width="60"/>
        <field name="rputype" required="true" indexed="true" caption="Property Type"/>
        <field name="txntype_objid" required="true" />
        <field name="classification_objid" required="true"/>
        <field name="classcode" required="true" caption="Class" />
        <field name="totalmv" type="decimal"  caption="M.V." width="100"/>
        <field name="totalav" type="decimal" caption="A.V." width="100"/>
        <field name="totalareaha" type="decimal"  caption="Area (ha)" width="90" />
        <field name="taxable" required="true" type="boolean" caption="Taxable" />
        <field name="prevtdno" searchable="true" caption="Previous TD No."/>
        <field name="titleno" searchable="true" caption="Title No."  width="80"/>
        <field name="totalareasqm" expr="totalareaha * 10000" caption="Area (sqm)" width="80" type="decimal" />
        <field name="ismanual" expr="case when faasid is null then 'M' else null end" caption="" width="30"/>
        
        <complex name="faases" ref="rptledger_faas" jointype="one-to-many" 
            required="true" orderBy="fromyear desc,fromqtr desc">
                <key field="objid" target="rptledgerid" />
        </complex>
        <complex name="taxpayer" ref="entity" jointype="many-to-one" required="true"
            includefields="name,address.text">
                <key field="taxpayer_objid" target="objid" />
        </complex>
        <complex name="barangay" ref="barangay" jointype="many-to-one" required="false"
            includefields="indexno,pin,name">
                <key field="barangayid" target="objid" />
        </complex>

    </element>


    <element name="credit" tablename="rptledger_credit">
        <field name="objid" primary="true" />
        <field name="rptledgerid" required="true" />
        <field name="type" required="true" />
        <field name="refno" required="true" />
        <field name="refdate" required="true" />
        <field name="payorid" />
        <field name="paidby_name" required="true" />
        <field name="paidby_address" required="true" />
        <field name="collector" required="true" />
        <field name="postedby" required="true" />
        <field name="postedbytitle" required="true" />
        <field name="dtposted" required="true" />
        <field name="fromyear" type="integer" required="true" />
        <field name="fromqtr" type="integer" required="true" />
        <field name="toyear" type="integer" required="true" />
        <field name="toqtr" type="integer" required="true" />
        <field name="basic" required="true" type="decimal" />
        <field name="basicint" required="true" type="decimal" />
        <field name="basicdisc" required="true" type="decimal" />
        <field name="basicidle" required="true" type="decimal" />
        <field name="sef" required="true" type="decimal" />
        <field name="sefint" required="true" type="decimal" />
        <field name="sefdisc" required="true" type="decimal" />
        <field name="firecode" required="true" type="decimal" />
        <field name="amount" required="true" type="decimal" />
        <field name="collectingagency" />
    </element>    
</schema>