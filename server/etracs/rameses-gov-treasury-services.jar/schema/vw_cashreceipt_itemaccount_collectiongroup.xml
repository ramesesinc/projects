<!--
DROP VIEW IF EXISTS vw_cashreceipt_itemaccount_collectiongroup;
CREATE VIEW vw_cashreceipt_itemaccount_collectiongroup AS 

SELECT 
ia.objid,ia.state,ia.code,ia.title,ia.description,ia.type,ia.fund_objid,ia.fund_code,ia.fund_title,
CASE WHEN ca.defaultvalue =0 THEN ia.defaultvalue ELSE ca.defaultvalue END AS defaultvalue,
CASE WHEN ca.valuetype IS NULL THEN ia.valuetype ELSE ca.valuetype END AS valuetype, 
CASE WHEN ca.sortorder=0 THEN ia.sortorder ELSE ca.sortorder END AS sortorder,
org_objid AS orgid, ca.collectiongroupid
FROM itemaccount ia
INNER JOIN collectiongroup_account ca ON ca.account_objid = ia.objid
WHERE (ia.generic = 0  OR ia.generic IS NULL)

UNION 

SELECT  
ia.objid,ia.state,ia.code,ia.title,ia.description,ip.type,ia.fund_objid,ia.fund_code,ia.fund_title,ca.defaultvalue,ca.valuetype, ca.sortorder, ia.org_objid AS orgid,
ca.collectiongroupid 
FROM itemaccount ia 
INNER JOIN itemaccount ip ON ia.parentid = ip.objid
INNER JOIN collectiongroup_account ca ON ca.account_objid = ip.objid
WHERE ip.generic = 1  

-->
<schema>
	<element tablename="vw_cashreceipt_itemaccount_collectiongroup">
		<field name="objid" primary="true"/>		
		<field name="state" />	
		<field name="code" />	
		<field name="title" />	
		<field name="description" />	
		<field name="type" />	
		<field name="fund_objid" />	
		<field name="fund_code" />	
		<field name="fund_title" />	
		<field name="defaultvalue" />
		<field name="sortorder" />		
		<field name="valuetype" />	
		<field name="orgid" />	
		<field name="collectiongroupid" />
	</element>
</schema>