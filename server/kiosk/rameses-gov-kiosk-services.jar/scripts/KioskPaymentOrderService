import com.rameses.annotations.*;
import com.rameses.util.*;
import java.rmi.server.*;
import java.text.*;
import com.rameses.common.*

public class KioskPaymentOrderService  {

	@DataContext("paymentorder")
	def paymentOrderEm;

	@Service("DateService")
	def dateSvc;

	@ProxyMethod
	public def post( def o ) {
		if(!o.barcodekey ) throw new Exception("Barcode key is required");
		def svrDate = dateSvc.getServerDate(); 

		def m = [:];
		def txnid = o.txnid;
		if(!txnid) {
			txnid = KeyGen.generateAlphanumKey( null, 8 );
		};	
		m.txnid = txnid;
		m.txndate = (!o.txndate) ? svrDate : o.txndate;
		m.payer = o.payer;
		m.paidby = o.paidby;
		m.paidbyaddress = o.paidbyaddress;
		m.amount = o.amount;
		m.collectiontype = o.collectiontype;
		m.refid = o.refid;
		m.refno = o.refno;
		m.info = o.info;
		paymentOrderEm.create( m );
	}


}