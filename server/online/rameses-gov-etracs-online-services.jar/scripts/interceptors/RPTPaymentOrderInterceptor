import com.rameses.annotations.*
import com.rameses.eserver.*;
import com.rameses.common.*;

class RPTPaymentOrderInterceptor
{
	@Service('RPTReceiptService')
    def receiptSvc 

	@After(pattern="PaymentOrderService.fetchPaymentInfo", eval="#{result.txntype == 'rptcol'}") 
	public void fetchInfo( evt ) {
		def entity = evt.result 
		def bill = [billid:entity.refid]
		bill.receiptdate = entity.dtposted
		entity.rptitems = [[rptledgerid:entity.info.rptledgerid]]
        entity.items = receiptSvc.getSummarizedItems(bill)
	}

}

