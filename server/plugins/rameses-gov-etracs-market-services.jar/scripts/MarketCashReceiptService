import com.rameses.annotations.*;
import com.rameses.util.*;
import java.rmi.server.*;
import com.rameses.services.extended.*;
import market.facts.*;
import java.text.*;

public class MarketCashReceiptService  {

	@Service("MarketBillingService")
	def billSvc;

	@DataContext("market_account")
	def acct;

	def dformat = new SimpleDateFormat("yyyy-MM-dd");

	@ProxyMethod
	public def getBilling(o) {
		def a = billSvc.getBilling( o );
		def z = [:];
		z.acctid = a.objid;
		z.acctno = a.acctno;
		z.acctname = a.acctname;
		z.rate = a.rate;
		z.fromdate = dformat.format(a.fromdate);
		z.todate = dformat.format(a.todate);
		z.amount = a.items.sum{ it.amount };
		z.items = a.items;
		z.paidby = a.owner;
		z.paidby = a.acctname + " (" + a.acctno + ")"; 
		z.paidbyaddress = a.unit.code;
		return z;
	}


}