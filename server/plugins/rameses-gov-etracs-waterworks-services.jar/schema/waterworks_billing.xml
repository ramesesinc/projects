<schema adapter="waterworks">
	<element tablename="waterworks_billing">
		<field name="objid" required="true" prefix="WBILL" />
		
		<complex name="account" ref="waterworks_account" jointype="many-to-one" 
			includefields="objid,acctname,acctno,address.text,classification.objid,stuboutnode.indexno,stuboutnode.stubout.code,meter.*"> 
			<key field="acctid" target="objid" />
		</complex>
		
		<complex name="batch" ref="waterworks_batch_billing" jointype="many-to-one" > 
			<key field="batchid" target="objid" />
		</complex>

		<field name="state" required="true"/>
		<field name="prevreadingdate" required="true"/>
		<field name="prevreading" required="true"/>
		<field name="readingdate" required="true"/>
		<field name="reading" required="true"/>
		<field name="reader_objid" required="true"/>
		<field name="reader_name" required="true"/>
		<field name="discrate" required="true" type="decimal"/>
		<field name="surcharge" required="true" type="decimal"/>
		<field name="interest" required="true" type="decimal"/>
		<field name="otherfees" required="true" type="decimal"/>
		<field name="advance" required="true" type="decimal"/>
		<field name="arrears" required="true" type="decimal"/>

		<field name="subtotal" expr="(arrears + otherfees + surcharge + interest) - advance" />

		<field name="unpaidmonths" required="true"/>
		<field name="volume" required="true" type="integer"/>
		<field name="amount" required="true" type="decimal"/>
		<field name="billed"/>
		<field name="year" required="true" type="integer"/>
		<field name="month" required="true"  type="integer"/>
		<field name="monthname" expr="MONTH_ARRAY( month )" caption="Month"/>

		<field name="averageconsumption"  type="integer"/>
	</element>
</schema>


