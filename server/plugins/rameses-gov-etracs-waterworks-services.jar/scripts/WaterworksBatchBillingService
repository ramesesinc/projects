import com.rameses.annotations.*;
import com.rameses.functions.*;

class WaterworksBatchBillingService {
	
	@DataContext('waterworks_billing_batch')
	def batchEm; 

	@ProxyMethod 
	public def post( def p ) {
		def hasitems = batchEm.select("cnt:{COUNT(*)}").find([batchid: p.objid]).where(" amount=0 AND state='DRAFT' ").first();	
		if(hasitems) throw new Exception("There are items that are not processed. Please process first");
		
	}


}