drop view if exists vw_waterworks_consumption
;
create view vw_waterworks_consumption as 
select wc.*, 
	s.year, s.month, s.fromperiod, s.toperiod, 
	s.readingdate, s.readingduedate, s.billingduedate, 
	s.discdate, s.duedate, sn.indexno, a.acctno, a.acctname  
from waterworks_consumption wc 
	inner join waterworks_account a on a.objid = wc.acctid 
	inner join waterworks_stubout_node sn on sn.objid = a.stuboutnodeid 
	left join waterworks_billing_schedule s on s.objid = wc.scheduleid 
;