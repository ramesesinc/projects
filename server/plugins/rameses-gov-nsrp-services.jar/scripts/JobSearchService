import com.rameses.annotations.*;

class JobSearchService 
{
	@DataContext("entityindividual")
	def entity;

	@DataContext("entity_education")
	def education;

	@DataContext("entity_eligibility")
	def eligibility;

	@DataContext("entity_jobpreference_occupation")
	def occupation;

	@DataContext("entity_jobpreference_worklocation")
	def worklocation;

	@DataContext("entity_languageproficiency")
	def language;

	@DataContext("entity_skill")
	def skill;

	@DataContext("entity_training")
	def training;

	@DataContext("entity_workexperience")
	def workexperience;

	@ProxyMethod
	def search(searchtext){
		def list = [];
		def ids = [];
		def skill = skill.find(['name':searchtext]).list();
		if(!ids.contains(skill.entityid)) ids << skill.entityid;
		ids.each{
			def record = entity.find('objid':it).first();
			if(record) list << record; 
		}
		return list;
	}
}