import com.rameses.annotations.*;
import java.rmi.server.UID;

class WaterworksCashReceiptInterceptor{

	@Service('WaterworksCashReceiptService')
	def cashReceiptSvc;

	@After(pattern="CashReceiptService.post", eval="#{result.collectiontype?.handler == 'waterworks'}")
	public void postPayment(def evt) {
		def o = evt.args[0]; 
		if ( !o.info?.acctid ) throw new Exception('info.acctid is required');
		
		cashReceiptSvc.post( o );  
	}

	@After(pattern="CashReceiptVoidService.post",index=0,eval="#{result.receipt.collectiontype.handler=='waterworks'}")
	public void voidPayment(def evt) {
		def rct = evt.result.receipt;
		cashReceiptSvc.postVoid( rct );
	}

}