import com.rameses.annotations.*;

class WaterworksPaymentOrderInterceptor {
	
	@Service('WaterworksCashReceiptService') 
	def cashReceiptSvc; 

	@Env
	def env; 

	@Before( pattern="PaymentOrderService.open", eval="#{args[0].txnid.startsWith('WA')}" )
	public void beforeOpen( evt ) {
		def params = evt.args[0]; 
		def txnid = params.txnid; 
		def p = cashReceiptSvc.getBilling([ refno: txnid ]); 
		def info = p.info; 
		env.paymentorder = [info:p, txntype:'waterworks_application',txnid:info.acctid,refid:info.acctid];  
	}
}	