import com.rameses.annotations.*;

import treasury.utils.*;
import treasury.facts.*;
import enterprise.utils.*;
import com.rameses.annotations.*;
import com.rameses.util.*;
import java.rmi.server.*;
import java.util.*;


public class CollectionAssessmentInterceptor {
	

	@After(pattern="FactBuilderService.getFacts", eval="#{ args[0] == 'collection'  }")
	public void buildFacts(def evt) {
		def factBuilder = evt.result; 
		def params = evt.args[1];
		def facts = factBuilder.facts;

		def vp = new VariableInfoProvider(
			schemaName:"variableinfo"
		);

		vp.createDecimalFact = { new enterprise.facts.DecimalInfo() };
		vp.createIntegerFact = { new enterprise.facts.IntegerInfo() };
		vp.createBooleanFact = { new enterprise.facts.BooleanInfo() };
		vp.createStringFact = { new enterprise.facts.StringInfo() };

		factBuilder.variableInfoProvider = vp;

		if( params.collectiongroup &&  !facts.find{it.class == treasury.facts.CollectionGroup.class } ) {
			def cg = params.collectiongroup;
			facts << new treasury.facts.CollectionGroup( objid:cg.objid, name: cg.name );
		}



	}




}